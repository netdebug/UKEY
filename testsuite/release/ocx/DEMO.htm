<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml">
 <head>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <title>RS_CertSafe.cab测试DEMO</title>
</head>
<script type="text/javascript" language="javascript">
	//1.获取证书列表
    function fGetUserList() {
        var ocxReach = document.getElementById("Object1").RS_GetUserList();
        document.getElementById("ResultContens1").innerHTML = ocxReach;
    }
	//2.获取数字证书
    function fGetCertBase64String() {
        var containerId = document.getElementById("txtGetCertBase64String_containerId").value;
        var certType = document.getElementById("txtGetCertBase64String_certType").value;
        var ocxReach = document.getElementById("Object1").RS_GetCertBase64String(containerId, certType);
        document.getElementById("ResultContens2").innerHTML = ocxReach;
    }
	//3.证书口令验证
    function fCertLogin() {
        var containerId = document.getElementById("txtCertLogin_containerId").value;
        var pwd = document.getElementById("txtCertLogin_pwd").value;
        var ocxReach = document.getElementById("Object1").RS_CertLogin(containerId, pwd);
        document.getElementById("ResultContens3").innerHTML = ocxReach;
    }
	//4.获取密码重试剩余次数
    function fGetPinRetryCount() {
        var containerId = document.getElementById("txtGetPinRetryCount_containerId").value;
        var ocxReach = document.getElementById("Object1").RS_GetPinRetryCount(containerId);
        document.getElementById("ResultContens4").innerHTML = ocxReach;
    }
	//5.修改证书口令
    function fChangePassWd() {
        var ocxReach = document.getElementById("Object1").RS_ChangePassWd();
        document.getElementById("ResultContens5").innerHTML = ocxReach;
    }
	//6.验证证书有效性
    function fVerifyIdentity() {
        var cert = document.getElementById("txtVerifyIdentity_cert").value;
        var authno = document.getElementById("txtVerifyIdentity_AuthNo").value;
        var ocxReach = document.getElementById("Object1").RS_VerifyIdentity(cert, authno);
        document.getElementById("ResultContens6").innerHTML = ocxReach;
    }
	//7.获取证书用户标识
    function fKeyGetKeySn() {
        var ocxReach = document.getElementById("Object1").RS_KeyGetKeySn();
        document.getElementById("ResultContens7").innerHTML = ocxReach;
    }
	//8.P1签名（域签）
    function fKeyDigitalSignByP1() {
        var containerId = document.getElementById("txtKeyDigitalSignByP1_containerId").value;
        var asn1Msg = document.getElementById("txtKeyDigitalSignByP1_asn1Msg").value;
        var ocxReach = document.getElementById("Object1").RS_KeyDigitalSignByP1(containerId, asn1Msg);
        document.getElementById("ResultContens8").innerHTML = ocxReach;
    }
	//9.P1验签（域签）
    function fVerifyDigitalSignByP1() {
        var cert = document.getElementById("txtVerifyDigitalSignByP1_certBase64").value;
        var Msg = document.getElementById("txtVerifyDigitalSignByP1_asn1Msg").value;
        var signdMsg = document.getElementById("txtVerifyDigitalSignByP1_signdMsg").value;
        var ocxReach = document.getElementById("Object1").RS_VerifyDigitalSignByP1(cert, Msg, signdMsg);
        document.getElementById("ResultContens9").innerHTML = ocxReach;
    }
	//10.P1签名
    function fKeySignByP1() {
        var containerId = document.getElementById("txtKeySignByP1_containerId").value;
        var msg = document.getElementById("txtKeySignByP1_msg").value;
        var ocxReach = document.getElementById("Object1").RS_KeySignByP1(msg, containerId);
        document.getElementById("ResultContens10").innerHTML = ocxReach;
    }
	//11.P1验签
    function fVerifySignByP1() {
        var cert = document.getElementById("txtVerifySignByP1_certBase64").value;
        var Msg = document.getElementById("txtVerifySignByP1_msg").value;
        var signdMsg = document.getElementById("txtVerifySignByP1_signdMsg").value;
        var ocxReach = document.getElementById("Object1").RS_VerifySignByP1(cert, Msg, signdMsg);
        document.getElementById("ResultContens11").innerHTML = ocxReach;
    }
	//12.P7签名
    function fKeySignByP7() {
        var containerId = document.getElementById("txtKeySignByP7_containerId").value;
        var Msg = document.getElementById("txtKeySignByP7_msg").value;
        var flag = document.getElementById("txtKeySignByP7_flag").value;
        var ocxReach = document.getElementById("Object1").RS_KeySignByP7(Msg, flag, containerId);
        document.getElementById("ResultContens12").innerHTML = ocxReach;
    }
	//13.非对称加密
    function fKeyEncryptData() {
        var rsKey = document.getElementById("txtKeyEncryptData_rsKey").value;
        var cert = document.getElementById("txtKeyEncryptData_certBase64").value;
        var ocxReach = document.getElementById("Object1").RS_KeyEncryptData(rsKey, cert);
        document.getElementById("ResultContens13").innerHTML = ocxReach;
    }
	//14.非对称解密
    function fKeyDecryptData() {
        var encRsKey = document.getElementById("txtKeyDecryptData_encRsKey").value;
        var ocxReach = document.getElementById("Object1").RS_KeyDecryptData(encRsKey);
        document.getElementById("ResultContens14").innerHTML = ocxReach;
    }
	//15.对称加密
    function fEncryptFile() {
        var souceFilePath = document.getElementById("txtEncryptFile_souceFilePath").value;
        var encFilePath = document.getElementById("txtEncryptFile_encFilePath").value;
        var ocxReach = document.getElementById("Object1").RS_EncryptFile(souceFilePath, encFilePath);
        document.getElementById("ResultContens15").innerHTML = ocxReach;
    }
	//16.对称解密
    function fDevryptFile() {
        var symKey = document.getElementById("txtDevryptFile_symKey").value;
        var encFilePath = document.getElementById("txtDevryptFile_encFilePath").value;
        var dncDirectoryPath = document.getElementById("txtDevryptFile_dncDirectoryPath").value;
        var ocxReach = document.getElementById("Object1").RS_DevryptFile(symKey, encFilePath, dncDirectoryPath);
        document.getElementById("ResultContens16").innerHTML = ocxReach;
    }
	//17.数字信封加密接口
    function fKeyEncryptByDigitalEnvelope() {
        var souceFilePath = document.getElementById("txtKeyEncryptByDigitalEnvelope_souceFilePath").value;
        var encFilePath = document.getElementById("txtKeyEncryptByDigitalEnvelope_encFilePath").value;
        var certBase64 = document.getElementById("txtKeyEncryptByDigitalEnvelope_certBase64").value;
        var ocxReach = document.getElementById("Object1").RS_KeyEncryptByDigitalEnvelope(souceFilePath, encFilePath, certBase64);
        document.getElementById("ResultContens17").innerHTML = ocxReach;
    }
	//18.数字信封解密接口
    function fKeyDecryptByDigitalEnvelope() {
        var encFilePath = document.getElementById("txtKeyDecryptByDigitalEnvelope_encFilePath").value;
        var dncDirectoryPath = document.getElementById("txtKeyDecryptByDigitalEnvelope_dncDirectoryPath").value;
        var encRsKeyPath = document.getElementById("txtKeyDecryptByDigitalEnvelope_encRsKeyPath").value;
        var ocxReach = document.getElementById("Object1").RS_KeyDecryptByDigitalEnvelope(encFilePath, dncDirectoryPath, encRsKeyPath);
        document.getElementById("ResultContens18").innerHTML = ocxReach;
    }
    //19.获取证书信息接口
    function fGetCertInfo() {
        var certBase64 = document.getElementById("txtGetCertInfo_cert").value;
        var Typei = document.getElementById("txtGetCertInfo_Type").value;
        var ocxReach = document.getElementById("Object1").RS_GetCertInfo(certBase64, Typei);
        document.getElementById("ResultContens19").innerHTML = ocxReach;
    }

</script>
<body>
<object id="Object1" classid="clsid:F84C8F57-5A05-4D8C-826D-29589C7A121C" style="LEFT: 10px; TOP: 10px" height="100" width="100" codebase="RS_CertSafe.CAB#version=2,0,3,10" >  </object>
    <br /><br /><br /><br />
	<div style="width: 1500px; position: absolute; z-index: inherit;">
    
    
        <div style="width: 1250px; float: left;">
			
		<strong>1、获取证书列表</strong><br /><br />
        <input type="button" id="btnGetUserList" value="获取证书列表" onclick="fGetUserList()" />
		<br /><br />
		<textarea id="ResultContens1" name="S1" cols="150" rows="5" ></textarea>
        <br /><br />
			
			
		<strong>2、获取数字证书</strong><br /><br />
			
		唯一标识：
				
        <input type="text" id="txtGetCertBase64String_containerId" style="width:1135px" />  <br /><br />
				
        证书类型(1:签名证书 2:加密证书):
				
        <input type="text" id="txtGetCertBase64String_certType" style="width:980px" />
				
				<br /><br />
        <input type="button" id="btnGetCertBase64String" value="获取数字证书" onclick="fGetCertBase64String()" />
		<br /><br />
		<textarea id="ResultContens2" name="S2" cols="150" rows="13" ></textarea>
        <br /><br />
		
		<strong>3、证书口令验证</strong><br /><br />
        唯一标识：
        <input type="text" id="txtCertLogin_containerId" style="width:1135px"  /><br /><br />
        证书密码：
        <input type="password" id="txtCertLogin_pwd" style="width:1135px" /><br /><br />
        <input type="button" id="btnCertLogin" value="证书口令验证" onclick="fCertLogin()" /><br /><br />
		<textarea id="ResultContens3" name="S3" cols="150" rows="5" ></textarea>
        <br /><br />

		<strong>4、获取密码重试剩余次数</strong><br /><br />
        唯一标识：
        <input type="text" id="txtGetPinRetryCount_containerId" style="width:1135px" /><br /><br />
        <input type="button" id="btnGetPinRetryCount" value="获取密码重试剩余次数" onclick="fGetPinRetryCount()" />
        <br /><br />
		<textarea id="ResultContens4" name="S4" cols="150" rows="5" ></textarea>
		<br /><br />

		<strong>5、修改证书口令</strong><br /><br />
        <input type="button" id="btnChangePassWd" value="修改证书口令" onclick="fChangePassWd()" />
        <br /><br />
		<textarea id="ResultContens5" name="S5" cols="150" rows="5" ></textarea>
		<br /><br />

		<strong>6、验证证书有效性</strong><br /><br />
        证书base64编码：
        <input type="text" id="txtVerifyIdentity_cert" style="width:1090px" /><br /><br />
        授权码：
        <input type="text" id="txtVerifyIdentity_AuthNo" style="width:1150px" /><br /><br />
        <input type="button" id="btnVerifyIdentity" value="验证证书有效性" onclick="fVerifyIdentity()" />
        <br /><br />
		<textarea id="ResultContens6" name="S6" cols="150" rows="5" ></textarea>
		<br /><br />
		

		<strong>7、获取证书用户标识</strong><br /><br />
        <input type="button" id="btnKeyGetKeySn" value="获取证书用户标识" onclick="fKeyGetKeySn()" />
        <br /><br />
		<textarea id="ResultContens7" name="S7" cols="150" rows="8" ></textarea>
		<br /><br />

		<strong>8、P1签名（域签）</strong><br /><br />
        唯一标识：
        <input type="text" id="txtKeyDigitalSignByP1_containerId" style="width:1135px" /><br /><br />
        待签名原文：
        <input type="text" id="txtKeyDigitalSignByP1_asn1Msg" style="width:1120px"  />   <br /><br />
        <input type="button" id="btnKeyDigitalSignByP1" value="P1签名（域签）" onclick="fKeyDigitalSignByP1()" />
        <br /><br />
		<textarea id="ResultContens8" name="S8" cols="150" rows="5" ></textarea>
		<br /><br />

		<strong>9、P1验签（域签）</strong><br /><br />
        base64编码的签名证书：
        <input type="text" id="txtVerifyDigitalSignByP1_certBase64" style="width:1042px" /><br /><br />
        待签名原文：
        <input type="text" id="txtVerifyDigitalSignByP1_asn1Msg" style="width:1120px" /><br /><br />
        签名值：
        <input type="text" id="txtVerifyDigitalSignByP1_signdMsg"  style="width:1150px" /> <br /><br />
        <input type="button" id="btnVerifyDigitalSignByP1" value="P1验签（域签）" onclick="fVerifyDigitalSignByP1()" />
        <br /><br />
		<textarea id="ResultContens9" name="S9" cols="150" rows="5" ></textarea>
		<br /><br />

		<strong>10、P1签名</strong><br /><br />
        唯一标识：
        <input type="text" id="txtKeySignByP1_containerId" style="width:1135px" /><br /><br />
        待签名原文：
        <input type="text" id="txtKeySignByP1_msg" style="width:1120px" />    <br /><br />
        <input type="button" id="btnKeySignByP1" value="P1签名" onclick="fKeySignByP1()" />
        <br /><br />
		<textarea id="ResultContens10" name="S10" cols="150" rows="9" ></textarea>
		<br /><br />

		<strong>11、P1验签</strong><br /><br />
        base64编码的签名证书：
        <input type="text" id="txtVerifySignByP1_certBase64" style="width:1042px" />
		<br /><br />
        待签名原文：
        <input type="text" id="txtVerifySignByP1_msg" style="width:1120px" />
		<br /><br />
        签名值：
        <input type="text" id="txtVerifySignByP1_signdMsg" style="width:1150px" /> 
		<br /><br />
        <input type="button" id="btnVerifySignByP1" value="P1验签" onclick="fVerifySignByP1()" />
        <br /><br />
		<textarea id="ResultContens11" name="S11" cols="150" rows="5" ></textarea>
		<br /><br />
		

		<strong>12、P7签名</strong><br /><br />
        唯一标识：
        <input type="text" id="txtKeySignByP7_containerId" style="width:1135px" /><br /><br />
		
        待签名原文：
        <input type="text" id="txtKeySignByP7_msg" style="width:1120px" /><br /><br />
        是否带原文的标识(1:不带原文;0:带原文)：
        <input type="text" id="txtKeySignByP7_flag" style="width:920px" /> <br /><br />
        <input type="button" id="btnKeySignByP7" value="P7签名" onclick="fKeySignByP7()" /><br /><br />
		<textarea id="ResultContens12" name="S12" cols="150" rows="5" ></textarea>
		<br /><br />
		
		<strong>13、非对称加密</strong><br /><br />
        待加密明文：
        <input type="text" id="txtKeyEncryptData_rsKey" style="width:1120px" /><br /><br />
        证书base64编码：
        <input type="text" id="txtKeyEncryptData_certBase64" style="width:1090px" />  
		 <br /><br />
        <input type="button" id="btnKeyEncryptData" value="非对称加密" onclick="fKeyEncryptData()" />
        <br /><br />
		<textarea id="ResultContens13" name="S13" cols="150" rows="20" ></textarea>
		<br /><br />
		
		<strong>14、非对称解密</strong><br /><br />
        待解密的密文：
        <input type="text" id="txtKeyDecryptData_encRsKey" style="width:1105px" /><br /><br />
        <input type="button" id="btnKeyDecryptData" value="非对称解密" onclick="fKeyDecryptData()" />
        <br /><br />
		<textarea id="ResultContens14" name="S14" cols="150" rows="8" ></textarea>
		<br /><br />

		<strong>15、对称加密</strong><br /><br />
        待加密文件路径：
        <input type="file" id="txtEncryptFile_souceFilePath" style="width:1085px" /><br /><br />
        加密后文件保存路径：
        <input type="text" id="txtEncryptFile_encFilePath" style="width:1055px" /> <br /><br />   
        <input type="button" id="btnEncryptFile" value="对称加密" onclick="fEncryptFile()" />
        <br /><br />
		<textarea id="ResultContens15" name="S15" cols="150" rows="8" ></textarea>
		<br /><br />
		<strong>16、对称解密</strong><br /><br />
        对称密钥原文：
        <input type="text" id="txtDevryptFile_symKey" style="width:1100px" /><br /><br />
        加密文件路径：
        <input type="file" id="txtDevryptFile_encFilePath" style="width:1100px" /><br /><br />
        解密后文件保存路径：
        <input type="text" id="txtDevryptFile_dncDirectoryPath" style="width:1055px" /> <br /><br />
        <input type="button" id="btnDevryptFile" value="对称解密" onclick="fDevryptFile()" />
        <br /><br />
		<textarea id="ResultContens16" name="S16" cols="150" rows="5" ></textarea>
		<br /><br />

		<strong>17、数字信封加密接口</strong><br /><br />
        原文路径：
        <input type="file" id="txtKeyEncryptByDigitalEnvelope_souceFilePath" style="width:1135px" /><br /><br />
        加密后的密文保存路径：
        <input type="text" id="txtKeyEncryptByDigitalEnvelope_encFilePath" style="width:1040px" /><br /><br />
        证书base64编码：
        <input type="text" id="txtKeyEncryptByDigitalEnvelope_certBase64" style="width:1090px" /> <br /><br />
        <input type="button" id="btnKeyEncryptByDigitalEnvelope" value="数字信封加密接口" onclick="fKeyEncryptByDigitalEnvelope()" />
        <br /><br />
		<textarea id="ResultContens17" name="S17" cols="150" rows="5" ></textarea>
		<br /><br />
		
		<strong>18、数字信封解密接口</strong><br /><br />
        要解密的文件路径：
        <input type="file" id="txtKeyDecryptByDigitalEnvelope_encFilePath" style="width:1065px" /><br /><br />
		对称密钥信息文件路径：
        <input type="file" id="txtKeyDecryptByDigitalEnvelope_encRsKeyPath" style="width:1035px" /> <br /><br />
        解密后文件保存文件夹路径：
        <input type="text" id="txtKeyDecryptByDigitalEnvelope_dncDirectoryPath" style="width:1000px" /><br /><br />
        
        <input type="button" id="btnKeyDecryptByDigitalEnvelope" value="数字信封解密接口" onclick="fKeyDecryptByDigitalEnvelope()" />
		<br /><br />
		<textarea id="ResultContens18" name="S18" cols="150" rows="5" ></textarea>
		<br /><br />

        <strong>19、获取证书信息接口</strong><br /><br />
        证书base64编码：
        <input type="text" id="txtGetCertInfo_cert" style="width:1090px" /><br /><br />
        信息标识( 2 证书序列号)：
        <input type="text" id="txtGetCertInfo_Type" style="width:1026px" /><br /><br />
        <input type="button" id="btnGetCertInfo" value="数字信封解密接口" onclick="fGetCertInfo()" /><br /><br />
        <textarea id="ResultContens19" name="S19" cols="150" rows="8" ></textarea>
        <br /><br />
        <br /><br />
        </div>

        <div style="width: 227px; float: right;">
        <textarea id="ResultContens" name="S0" cols="30" rows="53" hidden="true"></textarea>
        </div>
    </div>
</body>
</html>
